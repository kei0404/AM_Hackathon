<!--
同期影響レポート:
バージョン変更: 1.0.0 → 1.0.1 (PATCH: 全内容を日本語に翻訳)
変更された原則: なし（翻訳のみ）
追加セクション: なし
削除セクション: なし
更新が必要なテンプレート:
  ✅ plan-template.md - Constitution Checkセクションを日本語に更新
  ✅ spec-template.md - 変更不要（言語非依存）
  ✅ tasks-template.md - 変更不要（言語非依存）
フォローアップTODO: なし
-->

# AM Hackathon 憲章

## 基本原則

### I. PEP 8準拠（必須）
すべてのPythonコードはPEP 8（Pythonコードスタイルガイド）に準拠しなければなりません。これには以下が含まれます：
- 最大行長：コードは79文字、コメント/ドキュメント文字列は72文字
- インデントレベルごとに4スペースを使用（タブは使用しない）
- インポート文：標準ライブラリ → サードパーティ → ローカル、各グループは空行で区切る
- 命名規則：関数/変数は`snake_case`、クラスは`PascalCase`、定数は`UPPER_CASE`
- 空白：デフォルト値を持つ関数引数の`=`の周りには空白を入れない、演算子の周りには空白を入れる
- 複数行の構造（リスト、タプル、辞書）では末尾カンマを推奨（diffを容易にするため）

**理由**: PEP 8はコードベース全体の一貫性を確保し、可読性を向上させ、Pythonコミュニティの標準に準拠します。自動化ツール（black、flake8、pylint）がこれらのルールを強制します。

### II. 型ヒント（必須）
すべての関数シグネチャとクラス属性は、PEP 484およびPEP 526に従って型ヒントを含めなければなりません：
- 複雑な型には`typing`モジュールを使用（List、Dict、Optional、Unionなど）
- 単純なケースには組み込み型を使用（Python 3.9以降：`List[str]`の代わりに`list[str]`）
- 戻り値の型を指定しなければならない（戻り値のない関数には`-> None`を使用）
- クラス属性に注釈を付ける必要がある
- 適切な場合は`typing.Protocol`を構造的サブタイピングに使用

**理由**: 型ヒントはコードの保守性を向上させ、静的型チェック（mypy）を有効にし、IDEサポートを強化し、インラインドキュメントとして機能します。

### III. ドキュメント文字列規約（必須）
すべてのモジュール、クラス、および公開関数は、PEP 257に従ってドキュメント文字列を持たなければなりません：
- ドキュメント文字列には三重二重引用符（`"""`）を使用
- モジュールのドキュメント文字列：目的を説明し、公開エクスポートをリスト化
- クラスのドキュメント文字列：目的を説明し、公開属性とメソッドを文書化
- 関数のドキュメント文字列：1行の要約、必要に応じて詳細な説明、複雑な関数にはArgs/Returns/Raisesセクション
- 一貫性のためにGoogleスタイルまたはNumPyスタイルのドキュメント文字列を推奨（プロジェクトごとに1つのスタイルを選択）

**理由**: ドキュメント文字列は必須のドキュメントを提供し、自動ドキュメント生成を可能にし、コードの発見性を向上させます。

### IV. エラーハンドリングとロギング
エラーハンドリングはPythonのベストプラクティスに従わなければなりません：
- 特定の例外タイプを使用（ベア`except:`句を避ける）
- ドメイン固有のエラーが必要な場合はカスタム例外を作成
- 開発者/オペレーター向けのすべての出力には`logging`モジュールを使用（`print`は使用しない）
- ログレベル：DEBUG（開発）、INFO（通常の操作）、WARNING（回復可能な問題）、ERROR（失敗）、CRITICAL（システム障害）
- エラーメッセージとログエントリにコンテキストを含める（適切な場合は構造化ロギングを使用）

**理由**: 適切なエラーハンドリングはデバッグ性とシステムの信頼性を向上させます。構造化ロギングは本番環境での監視とトラブルシューティングを可能にします。

### V. テスト標準（必須）
テストは以下の要件に従わなければなりません：
- テストフレームワークとして`pytest`を使用
- テストファイルは`test_*.py`または`*_test.py`という名前でなければならない
- テスト関数は`test_*`という名前でなければならない
- ユニットテスト：個々の関数/メソッドを単独でテスト
- 統合テスト：コンポーネント間の相互作用をテスト
- テストカバレッジ：重要なパスで80%以上のカバレッジを目標（`pytest-cov`を使用）
- テストのセットアップ/ティアダウンにはフィクスチャを使用
- 外部依存関係（API、データベース、ファイルシステム）をモック化

**理由**: 包括的なテストはコードの正確性を確保し、リグレッションを防ぎ、自信を持ってリファクタリングできるようにします。

### VI. 依存関係管理
依存関係は明示的に管理しなければなりません：
- 固定された依存関係には`requirements.txt`を使用（本番環境）
- 開発依存関係には`requirements-dev.txt`を使用
- モダンプロジェクトには`pyproject.toml`を検討（PEP 518）
- 本番環境では正確なバージョンを固定（`==`）、開発環境では範囲を許可（`>=`）
- 各依存関係が必要な理由を文書化
- セキュリティパッチのために依存関係を定期的に更新

**理由**: 明示的な依存関係管理は再現可能なビルドを確保し、「自分のマシンでは動作する」問題を防ぎます。

### VII. コード組織と構造
コード組織はPythonのベストプラクティスに従わなければなりません：
- パッケージ構造：パッケージをマークするために`__init__.py`ファイルを使用（空でも可）
- モジュール組織：可能な限りモジュールごとに1つのクラス/主要関数
- 循環インポートを避ける
- 実行可能スクリプトには`if __name__ == "__main__":`ガードを使用
- 関心の分離：モデル、サービス、コントローラー、ユーティリティを異なるモジュール/パッケージに分離
- 関数を集中させる（単一責任の原則）

**理由**: 明確な組織は保守性を向上させ、コードベースをナビゲートし理解しやすくします。

## コードスタイルとフォーマット

### 自動フォーマット
- コードフォーマットには`black`を使用（デフォルト設定、行長79）
- インポートの並び替えには`isort`を使用（blackと互換性あり）
- コミット前に`black`と`isort`を実行（可能な場合はpre-commitフックを使用）

### リンティング
- リンティングには`flake8`または`ruff`を使用（PEP 8準拠）
- 静的型チェックには`mypy`を使用
- リンティングツールをプロジェクト標準に合わせて設定
- PRをマージする前にすべてのリンティングエラーを修正

### Pre-commitフック
- 以下のpre-commitフックを設定：black、isort、flake8/ruff、mypy
- コードをコミットする前にフックがパスしなければならない
- プロジェクトREADMEにセットアッププロセスを文書化

## ドキュメント標準

### インラインドキュメント
- コメントは「何を」ではなく「なぜ」を説明（コードは自己文書化されるべき）
- すべての公開APIにドキュメント文字列を使用
- TODO/FIXMEコメントには可能な限り課題トラッカーへの参照を付ける

### 外部ドキュメント
- README.md：プロジェクト概要、セットアップ手順、使用例
- APIドキュメント：Sphinxまたは類似ツールを使用してドキュメント文字列から生成
- アーキテクチャ決定：ADR（Architecture Decision Records）形式で文書化
- 変更履歴：Keep a Changelog形式に従ってCHANGELOG.mdを維持

## テスト標準

### テスト組織
- テストディレクトリでソース構造をミラーリング
- 適切な場合はクラスで関連するテストをグループ化
- 説明的なテスト名を使用：`test_function_name_scenario_expected_result`
- 可能な限りテストごとに1つのアサーション（または明確に関連するアサーション）

### テストデータ
- 再利用可能なテストデータにはフィクスチャを使用
- 複雑なオブジェクトにはフィクスチャよりもファクトリーを優先
- テストデータを最小限に保ち、焦点を絞る
- 複数の入力をテストするには`pytest.mark.parametrize`を使用

### テストパフォーマンス
- ユニットテストは迅速に実行されなければならない（各テスト1秒未満）
- 遅いテストには`@pytest.mark.slow`を付ける
- CIでの並列テスト実行には`pytest-xdist`を使用

## 開発ワークフロー

### コードレビュー要件
- すべてのコード変更はマージ前にレビューされなければならない
- レビュアーは以下を確認しなければならない：PEP 8準拠、型ヒント、ドキュメント文字列、テストカバレッジ
- 重要な変更には少なくとも1つの承認が必要
- マージ前にすべてのレビューコメントに対応

### バージョン管理
- 意味のあるコミットメッセージを使用（可能な場合はConventional Commitsに従う）
- コミットを集中させる（1つの論理的な変更ごとに1つのコミット）
- すべての変更にフィーチャーブランチを使用
- 適切な場合はmain/masterにマージする前にコミットをスカッシュ

### CI/CD統合
- CIパイプラインでリンティング、型チェック、テストを実行
- CIが失敗した場合はマージをブロック
- CIでコードカバレッジのしきい値を強制
- 依存関係のセキュリティスキャンを自動化

## 禁止事項: Don'ts
- 破壊的な変更を行う
- 機密情報をコード内のに記述する
- ハードコーディング

## ガバナンス

### 修正手順
- 憲章の修正には以下が必要：提案、議論、プロジェクトメンテナーの承認
- CHANGELOG.mdに理由とともに修正を文書化
- セマンティックバージョニング（MAJOR.MINOR.PATCH）に従ってバージョン番号を更新
- 依存するテンプレートとドキュメントに変更を伝播

### コンプライアンスレビュー
- 定期的なコードレビューで憲章のコンプライアンスを確認
- 自動化ツール（black、flake8、mypy、pytest）が標準を強制
- 非準拠はコードマージ前に解決されなければならない
- 例外には文書化された正当化と承認が必要

### バージョニングポリシー
- **MAJOR**: 原則への後方互換性のない変更または必須要件の削除
- **MINOR**: 新しい原則の追加または既存原則の大幅な拡張
- **PATCH**: 明確化、文言の改善、タイポ修正、非意味的な改善

**バージョン**: 1.0.1 | **制定日**: 2025-01-27 | **最終更新**: 2025-01-27
