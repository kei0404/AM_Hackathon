---
description: 非エンジニア向けのCLAUDE.mdファイルを生成または更新するためのコマンドです。PLANS.mdを唯一の決定事項の所在として、明確な作業手順と制約を定義します。
allowed-tools:
  - functions.read_file
  - functions.write
  - functions.list_dir
  - functions.glob_file_search
  - functions.search_replace
---
# CLAUDE.md - AIエージェント運用ルール

あなたはエンジニアです。以下のテンプレートをベースにして、非エンジニアでも運用できるAIエージェント運用向けの `CLAUDE.md` ファイルを作成または更新してください。

## CLAUDE.md の形式

以下の構造に従って `CLAUDE.md` を作成してください。プロジェクト固有の内容は、プロジェクトの現状や既存ドキュメント（README.md、spec.md、PLANS.md 等）を参照して埋めてください。

### 1. **プロジェクトのゴール**

[プロジェクトの目標を簡潔に記述してください]
- プロジェクトが解決する問題
- 達成したい成果
- ビジネス価値

**例（プロジェクト固有の内容に置き換えてください）:**
- Excelで手作業で行っていた請求書作成業務を自動化し、CSVデータから請求書を自動生成するWebアプリケーションを構築する
- 業務効率化、ミス削減、承認フローの標準化、データ管理の一元化を実現する

### 2. **唯一の正の所在**

以下の文言を必ず含めてください：

```
正はPLANS.md。曖昧ならPLANS.mdを更新してから実装。

- PLANS.mdが唯一の決定事項の所在

- 仕様が曖昧な場合は、PLANS.mdを更新してから実装を開始する

- 既存の決定を黙って変更しない

- 詳細な仕様、背景、調査ログ、議事録は .docs/plans/ 配下に配置
```

### 3. **作業手順（非エンジニアでも回る"型"）**

以下の3ステップの作業手順を記載してください：

```
1. PLANS.mdの「次の1〜3ステップ」を更新

作業開始前に、PLANS.mdの「次の1〜3ステップ」セクションを確認・更新
作業範囲を明確にする

2. 影響範囲のファイルを列挙

実装前に、変更・追加・削除するファイルをリストアップ
影響範囲を把握する

3. 実装 → テスト → 変更点をPLANS.mdに反映

実装完了後、テストを実行
PLANS.mdの「変更履歴（要点のみ）」に変更点を記録
必要に応じて「現在の決定事項」を更新
```

### 4. **制約（絶対にやらないこと）**

以下の制約を必ず含めてください：

```
推測で仕様を作らない
仕様が不明確な場合は、PLANS.mdを更新してから実装する

推測で実装を進めない

既存の決定を黙って変更しない
PLANS.mdに記載されている決定事項を変更する場合は、事前にPLANS.mdを更新する

既存の決定を無視して実装しない

詳細をPLANS.mdに書かない
詳細な仕様、背景、調査ログ、議事録は .docs/plans/ 配下に配置
PLANS.mdは「最終意思決定と現在の方針」だけを残す

「今週の作業範囲」「次の1〜3ステップ」を長くしない
これらはAIの行動の起点になるため、必ず短く維持する
詳細は作業計画ドキュメントに記載
```

### 5. **成果物の定義（Definition of Done）**

以下の成果物の定義を記載してください：

#### 実装完了の条件

- テスト/ビルドが通る
- PLANS.mdの「変更履歴（要点のみ）」に変更点が記録されている
- 変更理由が残っている（必要に応じて .docs/plans/ に詳細を記載）
- 影響範囲のファイルが適切に更新されている
- コードレビューが完了している（必要に応じて）

#### ドキュメント更新の条件

- PLANS.mdの「現在の決定事項」が最新である
- 「次の1〜3ステップ」が更新されている
- 詳細な情報は .docs/plans/ 配下に適切に配置されている

### 6. **出力フォーマット**

提案時のテンプレートとして以下を記載してください：

```
## 提案

[実装内容の概要]

## 理由

[なぜこの実装が必要か、PLANS.mdのどの決定事項に基づくか]

## 実装手順

1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

## 影響範囲

- [変更するファイル1]
- [変更するファイル2]
- [追加するファイル1]

## リスク

- [リスク1と対応策]
- [リスク2と対応策]

## PLANS.md追記案

[PLANS.mdの「変更履歴（要点のみ）」に追加する内容]
```

### 7. **用語集・ドメイン前提**

プロジェクト固有の用語、ロール、フロー、データ構造などを記載してください。

**記載すべき項目の例（プロジェクトに応じて調整してください）:**

- **ロール**: システム内の役割定義
- **承認フロー**: 承認プロセスの状態遷移
- **データフォーマット**: 番号、コードなどのフォーマット定義
- **マスター**: マスターデータの定義
- **データ管理**: データ保存場所、移行計画など

**例（プロジェクト固有の内容に置き換えてください）:**

```
ロール

管理者（admin）: [説明]
作成者（creator）: [説明]
営業（sales）: [説明]
閲覧者（viewer）: [説明]

承認フロー

[状態1]: [説明]
[状態2]: [説明]

データフォーマット

[項目名]: [フォーマット説明]

マスター

[マスター名]: [説明]

データ管理

現在: [現在の実装]
将来: [将来の実装計画]
```

## CLAUDE.mdを作成する際の手順

1. **プロジェクトの現状把握**
   - プロジェクトルートのファイル構造を確認
   - README.md、spec.md、PLANS.md（存在する場合）を読み取り
   - プロジェクトの目的と技術スタックを把握

2. **情報の収集**
   - プロジェクト固有の情報（ロール、フロー、用語など）を既存ドキュメントから抽出
   - 不明な点は、一般的な説明や「[プロジェクト固有の内容に置き換えてください]」という注記を残す

3. **CLAUDE.mdの生成**
   - 上記のテンプレートに従って、収集した情報を埋め込む
   - プロジェクトルートに `CLAUDE.md` として保存

4. **確認**
   - 生成されたCLAUDE.mdの内容を確認
   - プロジェクト固有の内容が適切に埋められているか確認
   - 必要に応じて修正を提案

## ファイルの保存場所

プロジェクトルートに `CLAUDE.md` として保存してください。

## 注意事項

- プロジェクト固有の内容（ロール、承認フロー、用語集など）は、既存ドキュメントから推測できる範囲で記載してください
- 不明確な場合は、一般的な説明やプレースホルダーを残し、ユーザーが後で更新できるようにしてください
- 制約や作業手順の部分は、テンプレート通りに記載してください（これらは汎用的なルールです）

